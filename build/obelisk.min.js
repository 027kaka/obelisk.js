/*!
 * obelisk.js 0.2.1
 * https://github.com/rison/obelisk.js
 * MIT licensed
 *
 * Copyright (C) 2012 Max Huang http://risonhuang.com
 */
!function(a){"use strict";var b={};b.version="0.2.0",b.author="max huang",a.obelisk=b}(window),function(a){"use strict";var b=function(){this.initialize()},c=b.prototype;c.inner=null,c.border=null,c.borderHighlight=null,c.left=null,c.right=null,c.horizontal=null,c.leftSlope=null,c.rightSlope=null,c.initialize=function(){return this},c.toString=function(){return"[AbstractColor]"},a.AbstractColor=b}(obelisk),function(a){"use strict";var b=function(a,b,c,d,e){this.initialize(a,b,c,d,e)},c=b.prototype=new a.AbstractColor;c.BRIGHTNESS_GAIN=-20,c.initialize=function(b,c,d,e,f){return this.border=a.ColorGeom.get32(b||8882055),this.borderHighlight=a.ColorGeom.get32(c||16777215),this.left=a.ColorGeom.get32(d||13225936),this.right=a.ColorGeom.get32(e||14935011),this.horizontal=a.ColorGeom.get32(f||15658992),this},c.getByHorizontalColor=function(c){return new b(a.ColorGeom.applyBrightness(c,4*this.BRIGHTNESS_GAIN),a.ColorGeom.applyBrightness(c,0,!0),a.ColorGeom.applyBrightness(c,2*this.BRIGHTNESS_GAIN),a.ColorGeom.applyBrightness(c,this.BRIGHTNESS_GAIN),c)},c.toString=function(){return"[CubeColor]"},a.CubeColor=b}(obelisk),function(a){"use strict";var b=function(a,b){this.initialize(a,b)},c=b.prototype=new a.AbstractColor;c.BRIGHTNESS_GAIN=-20,c.initialize=function(b,c){return this.border=a.ColorGeom.get32(b||8882055),this.inner=a.ColorGeom.get32(c||15658734),this},c.getByInnerColor=function(b){return new a.SideColor(a.ColorGeom.applyBrightness(b,4*this.BRIGHTNESS_GAIN),b)},c.toString=function(){return"[SideColor]"},a.SideColor=b}(obelisk),function(a){"use strict";var b=function(){this.initialize()},c=b.prototype;c.xAxis=null,c.yAxis=null,c.zAxis=null,c.tall=!1,c.initialize=function(){return this},c.toString=function(){return"[AbstractDimension]"},a.AbstractDimension=b}(obelisk),function(a){"use strict";var b=function(a,b){this.initialize(a,b)},c=b.prototype=new a.AbstractDimension;c.initialize=function(a,b){if(this.xAxis=a||30,this.yAxis=b||30,1==this.xAxis%2||1==this.yAxis%2)throw new Error("x,yAxis must be even number");if(this.xAxis<=4||this.yAxis<=4)throw new Error("dimension is too small");return this},c.toString=function(){return"[BrickDimension]"},a.BrickDimension=b}(obelisk),function(a){"use strict";var b=function(a,b,c){this.initialize(a,b,c)},c=b.prototype=new a.AbstractDimension;c.initialize=function(a,b,c){if(this.xAxis=a||30,this.yAxis=b||30,this.zAxis=c||30,1==this.xAxis%2||1==this.yAxis%2)throw new Error("x,yAxis must be even number");if(this.xAxis<=4||this.yAxis<=4||this.zAxis<=2)throw new Error("dimension is too small");return this},c.toString=function(){return"[CubeDimension]"},a.CubeDimension=b}(obelisk),function(a){"use strict";var b=function(a,b){this.initialize(a,b)},c=b.prototype=new a.AbstractDimension;c.initialize=function(a,b){if(this.xAxis=a||30,this.zAxis=b||30,1==this.xAxis%2)throw new Error("xAxis must be even number");if(this.xAxis<=4||this.zAxis<=2)throw new Error("dimension is too small");return this},c.toString=function(){return"[SideXDimension]"},a.SideXDimension=b}(obelisk),function(a){"use strict";var b=function(a,b){this.initialize(a,b)},c=b.prototype=new a.AbstractDimension;c.initialize=function(a,b){if(this.yAxis=a||30,this.zAxis=b||30,1==this.yAxis%2)throw new Error("yAxis must be even number");if(this.yAxis<=4||this.zAxis<=2)throw new Error("dimension is too small");return this},c.toString=function(){return"[SideYDimension]"},a.SideYDimension=b}(obelisk),function(a){"use strict";var b=function(a,b,c){this.initialize(a,b,c)},c=b.prototype;c.imageData=null,c.canvas=null,c.context=null,c.initialize=function(b,c,d){if(!b>0||!c>0)throw new Error("BitmapData width or height is missing");return this.canvas=d?a.CanvasManager.getDefaultCanvas():a.CanvasManager.getNewCanvas(),this.canvas.setAttribute("width",b),this.canvas.setAttribute("height",c),this.context=this.canvas.getContext("2d"),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.imageData=this.context.createImageData(b,c),this},c.setPixel=function(a,b,c){var d=4*(b*this.imageData.width+a);this.setPixelByIndex(d,c)},c.setPixelByIndex=function(a,b){var c=this.imageData.data;c[a+0]=255&b>>>16,c[a+1]=255&b>>>8,c[a+2]=255&b>>>0,c[a+3]=255&b>>>24},c.checkPixelAvailable=function(a,b){var c=4*(b*this.imageData.width+a);return 0===this.imageData.data[c+3]},c.floodFill=function(a,b,c){if(0!==(255&c>>>24)){var d,e,f,g=a,h=b,i=[],j=[],k=[],l=this.imageData.width,m=this.imageData.height;if(!(0>g||0>h||g>=l||h>=m)){if(!this.checkPixelAvailable(g,h))throw new Error("Start point for flood fill is already filled");for(d=g;d>=0;d--){for(e=h;e>=0;e--)if(this.checkPixelAvailable(d,e))i.push(4*(e*l+d)),j.push(e);else if(e!=h||!this.checkPixelAvailable(d+1,e-1))break;for(e=h;m>e;e++)if(this.checkPixelAvailable(d,e))i.push(4*(e*l+d)),j.push(e);else if(e!=h||!this.checkPixelAvailable(d+1,e+1))break;d==g&&(k=j.concat()),f=!1;for(var n in k){for(var o in j)if(j[o]==k[n]){f=!0,h=k[n];break}if(f)break}if(!f)break;k=j.concat(),j=[]}for(g=a,h=b,k=[],j=[],d=g;l>d;d++){for(e=h;e>=0;e--)if(this.checkPixelAvailable(d,e))i.push(4*(e*l+d)),j.push(e);else if(e!=h||!this.checkPixelAvailable(d-1,e-1))break;for(e=h;m>e;e++)if(this.checkPixelAvailable(d,e))i.push(4*(e*l+d)),j.push(e);else if(e!=h||!this.checkPixelAvailable(d-1,e+1))break;d==g&&(k=j.concat()),f=!1;for(var n in k){for(var o in j)if(j[o]==k[n]){f=!0,h=k[n];break}if(f)break}if(!f)break;k=j.concat(),j=[]}for(var n in i)this.setPixelByIndex(i[n],c)}}},c.toString=function(){return"[BitmapData]"},a.BitmapData=b}(obelisk),function(a){"use strict";var b=function(a,b){this.initialize(a,b)},c=b.prototype;c.x=null,c.y=null,c.canvas=null,c.initialize=function(b,c){if(!b)throw new Error("Primitive is not defined");var d=c||new a.Point3D;return this.canvas=b.canvas,this.x=b.matrix.tx+d.x-d.y,this.y=b.matrix.ty+Math.floor(d.x/2+d.y/2)-d.z,this},c.toString=function(){return"[PixelObject]"},a.PixelObject=b}(obelisk),function(a){"use strict";var b=function(a,b){this.initialize(a,b)},c=b.prototype;c.context=null,c.point=null,c.initialize=function(b,c){if(!b)throw new Error("Canvas is not defined");try{b instanceof jQuery&&(b=b.get(0))}catch(d){}return this.context=b.getContext("2d"),this.point=c||new a.Point(0,0),this},c.renderObject=function(b,c){var d=new a.PixelObject(b,c);this.context.drawImage(d.canvas,this.point.x+d.x,this.point.y+d.y)},c.toString=function(){return"[PixelView]"},a.PixelView=b}(obelisk),function(a){"use strict";var b=function(a,b,c,d,e,f){this.initialize(a,b,c,d,e,f)},c=b.prototype;c.a=1,c.b=0,c.c=0,c.d=1,c.tx=0,c.ty=0,c.initialize=function(a,b,c,d,e,f){return this.a=null==a?1:a,this.b=b||0,this.c=c||0,this.d=null==d?1:d,this.tx=e||0,this.ty=f||0,this},c.toString=function(){return"[Matrix]"},a.Matrix=b}(obelisk),function(a){"use strict";var b=function(a,b){this.initialize(a,b)},c=b.prototype;c.x=0,c.y=0,c.initialize=function(a,b){return this.x=null==a?0:a,this.y=null==b?0:b,this},c.toString=function(){return"[Point x : "+this.x+", y : "+this.y+"]"},a.Point=b}(obelisk),function(a){"use strict";var b=function(a,b,c){this.initialize(a,b,c)},c=b.prototype;c.x=0,c.y=0,c.z=0,c.initialize=function(a,b,c){return this.x=null==a?0:a,this.y=null==b?0:b,this.z=null==c?0:c,this},c.toString=function(){return"[Point3D x : "+this.x+", y : "+this.y+", z: "+this.z+"]"},a.Point3D=b}(obelisk),function(a){"use strict";var b=function(){this.initialize()},c=b.prototype;c.canvas=null,c.w=null,c.h=null,c.dimension=null,c.color=null,c.border=null,c.bitmapData=null,c.useDefaultCanvas=null,c.matrix=null,c.initialize=function(){return this},c.toString=function(){return"[AbstractPrimitive]"},a.AbstractPrimitive=b}(obelisk),function(a){"use strict";var b=function(a,b,c,d){this.initialize(a,b,c,d)},c=b.prototype=new a.AbstractPrimitive;c.initialize=function(a,b,c,d){return this.initRender(a,b,c,d),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this},c.initRender=function(b,c,d,e){this.useDefaultCanvas=e||!1,this.border=d||null==d,this.dimension=null==b?new a.BrickDimension:b,this.color=null==c?new a.SideColor:c,this.border||(this.color.border=this.color.inner)},c.initRectangle=function(){this.w=this.dimension.xAxis+this.dimension.yAxis,this.h=(this.dimension.xAxis+this.dimension.yAxis)/2,this.w-=2,this.h-=1,this.matrix=new a.Matrix,this.matrix.tx=-this.dimension.yAxis+2,this.matrix.ty=0},c.initBitmapData=function(){this.bitmapData=new a.BitmapData(this.w,this.h,this.useDefaultCanvas)},c.renderBitmapDataForCanvas=function(){this.bitmapData.context.putImageData(this.bitmapData.imageData,0,0),this.canvas=this.bitmapData.canvas},c.build=function(){for(var a=this.dimension.yAxis-2,b=0,c=this.dimension.xAxis-1,d=this.h-1,e=0;e<this.dimension.xAxis;e++)this.bitmapData.setPixel(a+e,b+Math.floor(e/2),this.color.border),this.bitmapData.setPixel(c-e,d-Math.floor(e/2),this.color.border);for(var f=0;f<this.dimension.yAxis;f++)this.bitmapData.setPixel(a+1-f,b+Math.floor(f/2),this.color.border),this.bitmapData.setPixel(c-1+f,d-Math.floor(f/2),this.color.border);this.bitmapData.floodFill(Math.floor(this.w/2),Math.floor(this.h/2),this.color.inner)},c.toString=function(){return"[Brick]"},a.Brick=b}(obelisk),function(a){"use strict";var b=function(a,b,c,d){this.initialize(a,b,c,d)},c=b.prototype=new a.AbstractPrimitive;c.initialize=function(a,b,c,d){return this.initRender(a,b,c,d),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this},c.initRender=function(b,c,d,e){this.useDefaultCanvas=e||!1,this.border=d||null==d,this.dimension=null==b?new a.CubeDimension:b,this.color=null==c?new a.CubeColor:c,this.border||(this.color.border=this.color.inner)},c.initRectangle=function(){this.w=this.dimension.xAxis+this.dimension.yAxis,this.h=this.dimension.zAxis+(this.dimension.xAxis+this.dimension.yAxis)/2,this.w-=2,this.h-=1,this.matrix=new a.Matrix,this.matrix.tx=-this.dimension.yAxis+2,this.matrix.ty=-this.dimension.zAxis},c.initBitmapData=function(){this.bitmapData=new a.BitmapData(this.w,this.h,this.useDefaultCanvas)},c.renderBitmapDataForCanvas=function(){this.canvas=this.bitmapData.canvas},c.build=function(){var b=new a.Brick(new a.BrickDimension(this.dimension.xAxis,this.dimension.yAxis),new a.SideColor(this.color.border,this.color.horizontal),this.border),c=new a.SideX(new a.SideXDimension(this.dimension.xAxis,this.dimension.zAxis),new a.SideColor(this.color.border,this.color.left),this.border),d=new a.SideY(new a.SideYDimension(this.dimension.yAxis,this.dimension.zAxis),new a.SideColor(this.color.border,this.color.right),this.border),e=new a.PixelObject(b),f=new a.PixelObject(c),g=new a.PixelObject(d),h=this.bitmapData.context;h.drawImage(e.canvas,e.x+this.dimension.yAxis-2,e.y),h.drawImage(f.canvas,f.x,f.y+this.dimension.zAxis+this.dimension.yAxis/2-1),h.drawImage(g.canvas,g.x+this.w-2,f.y+this.dimension.zAxis+this.dimension.xAxis/2-1);var i=new a.BitmapData(this.w,this.h);if(this.border){for(var j=this.dimension.xAxis-2,k=(this.dimension.xAxis+this.dimension.yAxis)/2-2,l=0;l<this.dimension.xAxis-2;l++)i.setPixel(j+1-l,k-Math.floor(l/2),this.color.borderHighlight);for(var m=0;m<this.dimension.yAxis-2;m++)i.setPixel(j+m,k-Math.floor(m/2),this.color.borderHighlight);for(var n=0;n<this.dimension.zAxis;n++)i.setPixel(j,k+n,this.color.borderHighlight)}else for(var l=0;l<this.dimension.zAxis;l++)i.setPixel(this.dimension.xAxis-2,(this.dimension.xAxis+this.dimension.yAxis)/2-1+l,this.color.left);i.context.putImageData(i.imageData,0,0),h.drawImage(i.canvas,0,0)},c.toString=function(){return"[Cube]"},a.Cube=b}(obelisk),function(a){"use strict";var b=function(a,b,c,d){this.initialize(a,b,c,d)},c=b.prototype=new a.AbstractPrimitive;c.initialize=function(a,b,c,d){return this.initRender(a,b,c,d),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this},c.initRender=function(b,c,d,e){this.useDefaultCanvas=e||!1,this.border=d||null==d,this.dimension=null==b?new a.SideXDimension:b,this.color=null==c?new a.SideColor:c,this.border||(this.color.border=this.color.inner)},c.initRectangle=function(){this.w=this.dimension.xAxis,this.h=this.dimension.zAxis+this.dimension.xAxis/2,this.matrix=new a.Matrix,this.matrix.tx=0,this.matrix.ty=-this.dimension.zAxis},c.initBitmapData=function(){this.bitmapData=new a.BitmapData(this.w,this.h,this.useDefaultCanvas)},c.renderBitmapDataForCanvas=function(){this.bitmapData.context.putImageData(this.bitmapData.imageData,0,0),this.canvas=this.bitmapData.canvas},c.build=function(){for(var a=0,b=this.dimension.zAxis,c=this.dimension.xAxis-1,d=this.h-this.dimension.zAxis-1,e=0;e<this.dimension.xAxis;e++)this.bitmapData.setPixel(a+e,b+Math.floor(e/2),this.color.border),this.bitmapData.setPixel(c-e,d-Math.floor(e/2),this.color.border);for(var f=0;f<this.dimension.zAxis;f++)this.bitmapData.setPixel(a,b-f,this.color.border),this.bitmapData.setPixel(c,d+f,this.color.border);this.bitmapData.floodFill(Math.floor(this.w/2),Math.floor(this.h/2),this.color.inner)},c.toString=function(){return"[SideX]"},a.SideX=b}(obelisk),function(a){"use strict";var b=function(a,b,c,d){this.initialize(a,b,c,d)},c=b.prototype=new a.AbstractPrimitive;c.initialize=function(a,b,c,d){return this.initRender(a,b,c,d),this.initRectangle(),this.initBitmapData(),this.build(),this.renderBitmapDataForCanvas(),this},c.initRender=function(b,c,d,e){this.useDefaultCanvas=e||!1,this.border=d||null==d,this.dimension=null==b?new a.SideYDimension:b,this.color=null==c?new a.SideColor:c,this.border||(this.color.border=this.color.inner)},c.initRectangle=function(){this.w=this.dimension.yAxis,this.h=this.dimension.zAxis+this.dimension.yAxis/2,this.matrix=new a.Matrix,this.matrix.tx=-this.dimension.yAxis+2,this.matrix.ty=-this.dimension.zAxis},c.initBitmapData=function(){this.bitmapData=new a.BitmapData(this.w,this.h,this.useDefaultCanvas)},c.renderBitmapDataForCanvas=function(){this.bitmapData.context.putImageData(this.bitmapData.imageData,0,0),this.canvas=this.bitmapData.canvas},c.build=function(){for(var a=0,b=this.h-this.dimension.zAxis-1,c=this.dimension.yAxis-1,d=this.dimension.zAxis,e=0;e<this.dimension.yAxis;e++)this.bitmapData.setPixel(a+e,b-Math.floor(e/2),this.color.border),this.bitmapData.setPixel(c-e,d+Math.floor(e/2),this.color.border);for(var f=0;f<this.dimension.zAxis;f++)this.bitmapData.setPixel(a,b+f,this.color.border),this.bitmapData.setPixel(c,d-f,this.color.border);this.bitmapData.floodFill(Math.floor(this.w/2),Math.floor(this.h/2),this.color.inner)},c.toString=function(){return"[SideY]"},a.SideY=b}(obelisk),function(a,b){"use strict";var c=function(){throw new Error("ColorGeom is a static Class, cannot be instanced.")},d=c;d.defaultCanvas=null,d.getDefaultCanvas=function(){return d.defaultCanvas=d.defaultCanvas||b.createElement("canvas"),d.defaultCanvas},d.getNewCanvas=function(){return b.createElement("canvas")},d.toString=function(){return"[CanvasManager]"},a.CanvasManager=c}(obelisk,document),function(a){"use strict";var b=function(){throw new Error("ColorGeom is a static Class, cannot be instanced.")},c=b;c.get32=function(a){return 4278190080>a?a+4278190080:a},c.applyBrightness=function(a,b,c){var d,e,f,g=255&a>>>24,h=255&a>>>16,i=255&a>>>8,j=255&a;return d=(313524*h>>20)+(615514*i>>20)+(119538*j>>20),f=-(155189*h>>20)-(303038*i>>20)+(458227*j>>20),e=(644874*h>>20)-(540016*i>>20)-(104857*j>>20),c?d=60+Math.pow(d,1.2):d+=b,h=d+(1195376*e>>20),i=d-(408944*f>>20)-(608174*e>>20),j=d+(2128609*f>>20),h=Math.max(0,Math.min(h,255)),i=Math.max(0,Math.min(i,255)),j=Math.max(0,Math.min(j,255)),g<<24|h<<16|i<<8|j},c.toString=function(){return"[ColorGeom]"},a.ColorGeom=b}(obelisk),function(a){"use strict";var b=function(){throw new Error("ColorGeom is a static Class, cannot be instanced.")},c=b;c.GRASS_GREEN=13434624,c.YELLOW=16776960,c.WINE_RED=16711833,c.PINK=16743615,c.PURPLE=13369599,c.BLUE=52479,c.GRAY=15658734,c.BLACK=6710886,c.FINE_COLORS=[c.GRASS_GREEN,c.YELLOW,c.WINE_RED,c.PINK,c.PURPLE,c.BLUE,c.GRAY,c.BLACK],c.getRandomComfortableColor=function(){return c.FINE_COLORS[Math.floor(Math.random()*c.FINE_COLORS.length)]},c.toString=function(){return"[ColorPattern]"},a.ColorPattern=b}(obelisk);